{% extends "srv/base.html" %}
{% load i18n %}
{% load staticfiles %}
{% block customjs %}
   <script type="text/javascript" src="{% static 'srv/js/yes.js' %}">
   </script>
{% endblock %}

{% block content %}
<div id="unrolled"></div>
<div id="compressed"></div>
<div class="view" id="webrtc">
  <h1>Webcam</h1>
  <p class="seeCompressed">{% trans "Video feedback" %}</p>
  {{ video }}
</div>
<script type="text/javascript">
  function view(url){ var i = $("iframe"); i.attr('src',url); }
</script>
<div class="view" id="author">{% trans "Authors' description and legal stuff" %}</div>
<div class="view" id="authorcomment">{% trans "The authors describe the experiment" %}</div>
<div class="view" id="comments">
  <h1>{% trans "Comments posted by visitors" %}</h1>
  {% for comment in comments %}
  <div class="comment">
    <span class="date">{{ comment.created_date }}</span>
    <strong>{{ comment.author }}</strong>
    <hr/>
    <p>{{ comment.text|linebreaks }}</p>
  </div>
  {% empty %}
  <p class="comment">{% trans "No comments here yet :(" %}</p>
  {% endfor %}
  {% if user.is_authenticated %}
  <a class="btn btn-default" href="/srv/add_comment">{% trans "Add comment" %}</a>
  {% endif %}
</div>
<div class="view" id="reservations">
  <h1>{% trans "Reservations" %}</h1>
  <table>
    <tr>
      <th>{% trans "Wanted reservation date:" %}</th>
      <td>
	<input class="datepicker" type="text" name="wantedDate" id="wantedDate" onchange="wantedDateChange()" value="{{date}}"/>
	<span id="tz">{% trans "timezone =" %} {% firstof user.profile.timezone "UTC" %}</span>
      </td>
    </tr>
  </table>
  <h2>{% trans "timeslots" %}</h2>
  <div id="resa">
    {{timeslots| safeseq|join:" "}}
  </div>
  <script type="text/javascript">
    $(function(){ // will be called when the document is ready
    updateResa({{resa|safe}}, '{{user.username}}');
    });
  </script>
</div>
<div class="view" id="params">
  <h1>{% trans "Parameters and action buttons for the experiment" %}</h1>
  {% for b in buttons %}
  {{b|safe}}
  <br/>
  {% endfor %}
</div>
<div class="view" id="outputs">{% trans "Data delivered by the previous runs of the experiment" %}</div>
<div id="message">
</div>
{% endblock %}
